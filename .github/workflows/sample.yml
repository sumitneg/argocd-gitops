name: Simple GitOps Workflow

on:
  pull_request:
    branches:
      - main
  push:
    branches:
      - main

jobs:
  # Stage 1: Build
  build:
    name: Build Stage
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Build step
        run: |
          echo "ï¿½ Building..."
          echo "Repository: ${{ github.repository }}"
          echo "Branch: ${{ github.ref_name }}"
          echo "âœ… Build completed!"

  # Stage 2: Test
  test:
    name: Test Stage
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Run tests
        run: |
          echo "ðŸ§ª Running tests..."
          echo "Commit: ${{ github.sha }}"
          echo "Author: ${{ github.actor }}"
          echo "âœ… All tests passed!"

  # Stage 3: Deploy (only on push to main)
  deploy:
    name: Deploy Stage
    runs-on: ubuntu-latest
    needs: test
    if: github.event_name == 'push' && github.ref == 'refs/heads/main'
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Deploy
        run: |
          echo "ðŸš€ Deploying..."
          echo "Deployment Time: $(date -u)"
          echo "âœ… Deployment successful!"

      - name: Notify
        run: |
          echo "ðŸ“¢ Notification sent!"
          echo "Deployment details:"
          echo "  - Commit: ${{ github.sha }}"
          echo "  - Author: ${{ github.actor }}"
